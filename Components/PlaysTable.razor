@using MagicDeckStats.Models

@if (Plays == null || !Plays.Any())
{
    <div class="alert alert-info">
        <i class="bi bi-info-circle"></i> No plays data available. Count: @(Plays?.Count ?? 0)
    </div>
}
else
{
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Duration</th>
                    <th class="flag-icon-column"></th>
                    <th>Winner</th>
                    <th>Player</th>
                    <th class="flag-icon-column"></th>
                    <th>Loser</th>
                    <th>Player</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var play in Plays)
                {
                    var winner = play.PlayerScores.FirstOrDefault(p => p.IsWinner);
                    var loser = play.PlayerScores.FirstOrDefault(p => !p.IsWinner);
                    
                    <tr>
                        <td>@DateTime.Parse(play.Date).ToString("yyyy-MM-dd")</td>
                        <td>@(play.DurationInMinutes > 0 ? $"{play.DurationInMinutes} min" : "-")</td>
                        <td class="flag-icon-column">
                            @if (winner?.IsStartPlayer == true)
                            {
                                <i class="bi bi-flag-fill text-warning" title="Starting Player"></i>
                            }
                        </td>
                        <td>
                            <span class="text-success fw-bold">@winner?.Deck</span>
                        </td>
                        <td>
                            @if (winner != null)
                            {
                                <span class="text-success">@winner.PlayerName</span>
                            }
                            else
                            {
                                <span class="text-muted">No winner</span>
                            }
                        </td>
                        <td class="flag-icon-column">
                            @if (loser?.IsStartPlayer == true)
                            {
                                <i class="bi bi-flag-fill text-warning" title="Starting Player"></i>
                            }
                        </td>
                        <td>
                            <span class="text-danger fw-bold">@loser?.Deck</span>
                        </td>
                        <td>
                            @if (loser != null)
                            {
                                <span class="text-danger">@loser.PlayerName</span>
                            }
                            else
                            {
                                <span class="text-muted">No loser</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

@code {
    [Parameter]
    public List<Play> Plays { get; set; } = new();
} 